<!-- wp:heading -->
<h1 class="wp-block-heading">migrate - WordPress Database Migration</h1>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Complete WordPress multisite database migration with automated export/import/archival workflow. The migrate command handles the entire process of moving WordPress site data between environments safely.</p>
<!-- /wp:paragraph -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Overview</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The migrate command supports two modes:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>**Complete Workflow** (default): Full automated migration with export/import/transform/backup/archival</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Simple Mode**: Uses migration database for search-replace only (assumes tables already imported)</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Usage</h2>
<!-- /wp:heading -->

<!-- wp:code -->
<pre class="wp-block-code"><code>wfuwp migrate <site-id> --from <source-env> --to <target-env> [options]</code></pre>
<!-- /wp:code -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Examples</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Complete Workflow</h3>
<!-- /wp:heading -->

<!-- wp:code -->
<pre class="wp-block-code"><code># Basic migration
wfuwp migrate 43 --from prod --to pprd

# Include WordPress file sync
wfuwp migrate 43 --from prod --to pprd --sync-s3</code></pre>
<!-- /wp:code -->



<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Simple Mode</h3>
<!-- /wp:heading -->

<!-- wp:code -->
<pre class="wp-block-code"><code># Phase 1 behavior - search-replace only
wfuwp migrate 43 --from prod --to pprd --simple</code></pre>
<!-- /wp:code -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Complete Workflow Steps</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>**Export** site tables from source environment</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Import** to migration database</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Transform** data with search-replace operations</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Backup** existing target tables</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Export** migrated tables from migration database</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Import** to target environment</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Sync** WordPress files between S3 environments (if --sync-s3)</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Archive** all SQL files (to S3 if configured, otherwise local backup directory)</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Cleanup** migration database</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Options</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>`--sync-s3` - Include WordPress file synchronization between S3 environments</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>`--simple` - Use simple mode (Phase 1 behavior)</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>`--skip-backup` - Skip backup of target tables (not recommended)</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>`--skip-s3` - Skip S3 archival even if configured</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>`--keep-files` - Keep local SQL files after archival</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>`--work-dir <path>` - Custom working directory for temporary files</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Safety Features</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>**Pre-flight checks** - Validates database connections, site existence, AWS CLI availability</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Target backups** - Automatically backs up existing target tables before import</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**S3 archival** - Archives all SQL files with metadata for audit trail</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Rollback capability** - Can restore from backups if migration fails</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Confirmation prompts** - Asks before destructive operations</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Progress tracking** - Shows step-by-step progress with file counts and sizes</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">WordPress Multisite Specifics</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>**Main site (ID 1)**: Tables like `wp_posts`, `wp_options`</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Subsites (ID > 1)**: Tables like `wp_43_posts`, `wp_43_options`</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Network tables**: Shared tables like `wp_users`, `wp_blogs` (excluded from site migrations)</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>**Automatic detection**: Identifies site-specific tables automatically</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Configuration Requirements</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The migrate command requires configuration for:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Source and target environment database connections</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>Migration database for temporary operations</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>Optional S3 configuration for archival</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>Optional local backup directory</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:paragraph -->
<p>See the <a href="config.md">config command documentation</a> for setup details.</p>
<!-- /wp:paragraph -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Common Use Cases</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>Production to Pre-Production:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>wfuwp migrate 43 --from prod --to pprd --sync-s3</code></pre>
<!-- /wp:code -->



<!-- wp:paragraph -->
<p><strong>UAT to Development:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>wfuwp migrate 12 --from uat --to dev</code></pre>
<!-- /wp:code -->



<!-- wp:paragraph -->
<p><strong>Simple search-replace only:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>wfuwp migrate 43 --from prod --to pprd --simple</code></pre>
<!-- /wp:code -->



<!-- wp:heading {"level":2} -->
<h2 class="wp-block-heading">Troubleshooting</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>Database connection errors:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Verify environment configuration with `wfuwp config verify`</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>Check database credentials and network connectivity</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:paragraph -->
<p><strong>Migration database issues:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Ensure migration database exists and is accessible</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>Check that user has CREATE, DROP, INSERT, SELECT permissions</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:paragraph -->
<p><strong>S3 archival failures:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Verify AWS CLI configuration with `aws configure list`</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>Check S3 bucket permissions and region settings</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:paragraph -->
<p><strong>File sync issues:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Ensure source and target S3 buckets exist</li>
<!-- /wp:list-item --><!-- wp:list-item -->
<li>Verify AWS credentials have S3 read/write permissions</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->



<!-- wp:paragraph -->
<p>For detailed configuration help, see: <code>wfuwp config --help</code></p>
<!-- /wp:paragraph -->